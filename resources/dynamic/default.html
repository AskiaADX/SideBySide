{%
Dim COLUMN_NUMBER = 5
Dim inputName
Dim inputId
Dim imageId
Dim inputIdDate
Dim inputCode
Dim inputValue
Dim isExclusive
Dim isAskiaExclusive
Dim isSelected
Dim caption
Dim i
Dim j
Dim k
Dim attrMulti
Dim attrChecked
Dim boolColMerge = False
Dim attrColMerge = ""
Dim column
Dim displayRow = ""
Dim showTotal = (CurrentADC.PropValue("showTotal") = "1")
Dim totalCaption = CurrentADC.PropValue("totalCaption")
Dim totalCaptionLeft = On(CurrentADC.PropValue("displayTotalCaption") = "0", totalCaption, "")
Dim totalCaptionCol  = On(CurrentADC.PropValue("displayTotalCaption") = "1", totalCaption, "")

For i = 1 To COLUMN_NUMBER
    column = CurrentADC.PropQuestion("questionCol"+i)
    if ((i = 1) And (column.Id = DK)) Then column = CurrentQuestion EndIf

    boolColMerge = boolColMerge Or (CurrentADC.PropValue("respOnHeader") = "1" And (column.Type = "single" Or column.Type="multiple"))
Next
%}
<div id="adc_{%= CurrentADC.InstanceId %}" class="adc-sidebyside">
	<table class="adc-sidebyside-table">
        {%If CurrentADC.PropValue("showTitle") = "1"  Then%}
    	<thead id="adc_{%= CurrentADC.InstanceId %}_thead">
            <tr>
                    <th class="firstColumn">&nbsp;</th>
            {%
			For i = 1 to COLUMN_NUMBER
    			column = CurrentADC.PropQuestion("questionCol"+i)
    			if ((i = 1) and (column.Id = DK)) Then	column = CurrentQuestion	EndIf

        		attrColMerge = On(((column.Type = "single") and (CurrentADC.PropValue("colAsComboBox"+i) = "0")) or (column.Type = "multiple"), "colspan=" + column.AvailableResponses.Count, "")
    			If column.Id <> DK then %}
                	<th class="otherColumn" {%= attrColMerge %}>
                        {%= column.LongCaption %}
            		</th>
            	{% Endif   
			Next
			%}
        	</tr>
    {%
		EndIf
		if boolColMerge Then
    %}
            <tr>
                <th class="firstColumn">&nbsp;</th>
     {%	  	For i = 1 to COLUMN_NUMBER
    				column = CurrentADC.PropQuestion("questionCol"+i)
    				if ((i = 1) And (column.Id = DK)) Then column = CurrentQuestion EndIf
    				Dim padRightHead = ""
                    If column.Id <> DK then %}                        
                            {% If ((CurrentADC.PropValue("respOnHeader") = "1") and ((column.Type = "multiple") or ((column.Type = "single") and (CurrentADC.PropValue("colAsComboBox"+i) = "0")))) Then%}
                                {% For k = 1 To column.AvailableResponses.Count
    								padRightHead = On(column.AvailableResponses[k].ResourceURL <> "" and CurrentADC.PropValue("imgZoomColumn") = "1" and CurrentADC.PropValue("respOnHeader") = "1"," padRight","")
    								imageId = column.AvailableResponses[k].InputName() %}
                					<th class="otherColumn{%:= padRightHead %}">
                                        {% If column.AvailableResponses[k].ResourceURL <> "" and CurrentADC.PropValue("iterationColumn") <> "0" Then%}
                                        	<img src="{%= column.AvailableResponses[k].ResourceURL %}" data-id="{%= imageId %}" class="image"><br />
                                        {%If CurrentADC.PropValue("imgZoomColumn") = "1" Then %}<a href="{%= column.AvailableResponses[k].ResourceURL %}" target="_blank" data-simplbox="{%= imageId %}" class="zoomLink"><div class="imgZoom"></div></a>{%EndIf%}
                                        {% EndIf %}
                                        {% If CurrentADC.PropValue("iterationColumn") <> "1" or column.AvailableResponses[k].ResourceURL = "" Then %}
                                        	{%= column.AvailableResponses[k].Caption %}
                                        {% EndIf%}
                                    </th>
                                {% Next %}
                			{%Else%}
                					<th class="otherColumn">&nbsp;</th>
                            {%EndIf%}
                    {% Endif   
                Next %}
			</tr>
			{% EndIf %}
  		</thead>
    
        <tbody>        	            
           
        {%For i = 1 To CurrentQuestion.ParentLoop.Answers.Count
            displayRow = On((CurrentADC.PropValue("stepByStep") = "1" And i>1), "hidden", "" )
            imageId = CurrentQuestion.ParentLoop.Answers[i].InputName() %}
            <tr id="row{%= i%}" {%= displayRow %} data-id='{%= imageId%}'>
            
            {%Dim select = CurrentQuestion.ParentLoop
				Dim padRightIteration = On(select.Answers[i].ResourceURL <> "" and CurrentADC.PropValue("imgZoomRow") = "1","padRight","")
				If select.Id<>DK Then 
    				attrChecked = On(select.Answers[i].IsSelected, "checked", "") %}
                <td class="{%= padRightIteration %}">
                    {% If select.Answers[i].ResourceURL <> "" and CurrentADC.PropValue("iterationColumn") <> "0" Then%}
                    	<img src="{%= select.Answers[i].ResourceURL %}" data-id="{%= select.Answers[i].Id %}" class="image" width="100%"><br />
                    	{% If CurrentADC.PropValue("imgZoomRow") = "1" Then %}<a href="{%= select.Answers[i].ResourceURL %}" target="_blank" data-simplbox="{%= imageId %}" class="zoomLink"><div class="imgZoom"></div></a>{% EndIf %}
                    {% EndIf %}
                   	{% If CurrentADC.PropValue("iterationColumn") <> "1" or select.Answers[i].ResourceURL = "" Then %}
    					{%:= select.Answers[i].Caption %}
                    {% EndIf%}
                </td>
            {%EndIf  %}
            
            {%
            For k = 1 To COLUMN_NUMBER
    			column = CurrentADC.PropQuestion("questionCol"+k)
    			if ((k = 1) And (column.Id = DK)) Then column = CurrentQuestion EndIf
    			If (column.Id <> DK) then
        			column = column.Alliterations[i]
        			If (column.Type = "single") Or (column.Type = "multiple") Then                        			
            			attrMulti = On((column.Type = "single"), "radio", "checkbox")
            			attrChecked = On(column.AvailableResponses[i].IsSelected, "checked", "")
              %}
                	
                        {% If (CurrentADC.PropValue("colAsComboBox"+k) >= "1") And column.Type = "single" Then 
            				inputName = column.InputName()
    						inputId     = (inputName + "_" + k).Replace("U", "askia-input-select")
            				inputCode = column.inputCode %}
            			<td class="col{%= k %}">
                            <select class="askia-question-{%= inputCode %}" id="{%= inputId%}" name="{%:= column.InputName()%}">
                            <option value="0">{%:= CurrentADC.PropValue("firstOptionCombo"+k) %}</option>
                            {% For j=1 to column.AvailableResponses.Count
    							 	Dim attrSelected = On(column.AvailableResponses[j].IsSelected, "selected=\"selected\"", "")%}
                            		<option {%:= attrSelected %} value="{%:= column.AvailableResponses[j].InputValue() %}">{%= column.AvailableResponses[j].Caption %}</option>
                    		{% Next %}
                        </select>
            			</td>
                   	{% Else %}
                        {% For j=1 to column.AvailableResponses.Count %}
                                {%If (column.Type = "single") Then
                                    inputName = column.AvailableResponses[j].InputName()
                                    inputId     = (inputName + "_" + j).Replace("U", "askia-input")
                                Else
                                    inputName = column.AvailableResponses[j].InputName()
                                    inputId     = inputName.Replace(" ", "_").Replace("M", "askia-input")
                                EndIf
    							inputCode = column.InputCode
    							inputValue  = column.AvailableResponses[j].InputValue()
                                attrChecked = On(column.AvailableResponses[j].IsSelected, "checked=\"checked\"", "")
                                caption     = column.AvailableResponses[j].Caption
                                isExclusive = On((column.AvailableResponses[j].IsExclusive) or (column.Type = "single"), " exclusive", "")
                                isAskiaExclusive = On((column.AvailableResponses[j].IsExclusive) or (column.Type = "single"), "askia-exclusive", "")
								isSelected = On(column.Answers.Index Has column.AvailableResponses[j].Index, " cell-selected", "")
								Dim padRight = On(column.AvailableResponses[j].ResourceURL <> "" and CurrentADC.PropValue("imgZoomColumn") = "1" and CurrentADC.PropValue("respOnHeader") = "0"," padRight","")
    						%}
                        	<td class="col{%= k %} response{%:= isExclusive %}{%:= isSelected %}{%:= padRight %}">
                                    <input type="{%:= attrMulti %}" id="{%:= inputId %}" class="{%:= isAskiaExclusive %} askia-question-{%= inputCode %}" name="{%:= inputName %}" value="{%:= inputValue %}" {%:= attrChecked %}>
                                    <label for="{%= inputId %}" class="askia-{%:= attrMulti %} askia-question-{%= inputCode %}"></label>
                                    {% If CurrentADC.PropValue("respOnHeader") = "0" Then %}
                                        {% If column.AvailableResponses[j].ResourceURL <> "" and CurrentADC.PropValue("iterationColumn") <> "0" Then%}
                                            <img src="{%= column.AvailableResponses[j].ResourceURL %}" data-id="{%= imageId %}" class="image"><br />
                                			{%If CurrentADC.PropValue("imgZoomColumn") = "1" Then %}<a href="{%= column.AvailableResponses[j].ResourceURL %}" target="_blank" data-simplbox="{%= imageId %}" class="zoomLink"><div class="imgZoom"></div></a>{%EndIf%}
                                        {% EndIf %}
                                        {% If CurrentADC.PropValue("iterationColumn") <> "1" or column.AvailableResponses[j].ResourceURL = "" Then %}
                                       		<label for="{%:= inputId %}" class="text" askia-question-{%= inputCode %}>{%= caption %}</label>
                                        {% EndIf%}
                                    {% EndIf %}
                    	{% Next %}
                  	{% EndIf %}
            		</td>
            {%		
					ElseIf (column.Type = "numeric") Then
                        inputName 	= column.InputName()
						inputId     	= (inputName + "_" + k).Replace("C", "askia-input-number")
						inputCode	 = column.InputCode %}
                            <td class="col{%= k %}">
                                <span class="askia-question-{%= inputCode %} number-element">
                                    <span class="prefix">{%= CurrentADC.PropValue("numBoxPrefix"+k) %}</span>
                                    <input type ="number" id="{%= inputId %}" name="{%:= inputName %}" value="{%:= column.InputValue() %}">
                                    <span class="suffix">{%= CurrentADC.PropValue("numBoxSuffix"+k) %}</span>
                                </span>
                            </td>
                        {%
					ElseIf (column.Type = "open") Then
                        inputName = column.InputName()
						inputId     = (inputName + "_" + k).Replace("S", "askia-input-open")
						inputCode	 = column.InputCode %}
                        <td class="col{%= k %}">
                            <input type ="text" class="askia-question-{%= inputCode %}" id="{%= inputId %}" name="{%:= inputName %}" value="{%:= column.InputValue() %}">
                        </td>
                	{% ElseIf (column.type = "datetime") Then %}
                	<td class="col{%= k %}">
                	{%
                        inputName = column.InputName()
						inputId     = (inputName + "_" + k).Replace("D", "askia-input-date")
						inputIdDate = (inputName + "_" + k).Replace("D", "askia-input-dateO")
						inputCode	 = column.InputCode
						Dim attrMin = On(column.MinDate.ToNumber() <> DK, "min=\"" + column.MinDate.Format("dd/MM/yyyy") + "\"", "")
    					Dim attrMax = On(column.MaxDate.ToNumber() <> DK, "max=\"" + column.MaxDate.Format("dd/MM/yyyy") + "\"", "")
						If (Not(column.IsTimeOnly)) Then %}
                        	<div class="RLDatePicker">
                            	<input type="text" id="{%= inputIdDate %}" class="askia-question-{%= inputCode %}" name="{%= inputName %}" value="{%= column.InputValue("date") %}" {%:= attrMin %} {%:= attrMax %} readonly="true"/>
                             </div>
                        {%	Endif %}
                        {% If (Not(column.IsDateOnly)) Then  %}
                             <div class="RLTimePicker">
                             	<select id="hour_{%= CurrentADC.InstanceId %}" name="hour"></select>
                                <span class="timeSeparator_{%= CurrentADC.InstanceId %}"></span>
                                <select id="minutes_{%= CurrentADC.InstanceId %}" name="minutes"></select>
                                <span id="secsContainer_{%= CurrentADC.InstanceId %}">
                                	<span class="timeSeparator_{%= CurrentADC.InstanceId %}"></span>
                                    <select id="seconds_{%= CurrentADC.InstanceId %}" name="seconds"></select>
                                </span>
                                <!--<input type="text" id="time" name="time" readonly="readonly" hidden=true/> -->
                                <input id="{%=inputId%}" class="askia-question-{%= inputCode %} time_{%= CurrentADC.InstanceId %}" hidden type="text" name="{%= inputName %}" />
                                <span class="imperial" {%If CurrentADC.PropValue("imperial") = "false" Then %} hidden {% EndIf %} id="ampm_{%= CurrentADC.InstanceId %}"></span>
                            </div>
                		{%	Endif %}
                </td>
                {%	Endif 
    			EndIf
			Next
            %}
            </tr>
            {%
	Next 
%}
    {% If showTotal Then%}
        <tr>
            <th>{%= totalCaptionLeft %}</th>
                {% For i = 1 to COLUMN_NUMBER
    				column = CurrentADC.PropQuestion("questionCol"+i)
    				if ((i = 1) And (column.Id = DK)) Then column = CurrentQuestion EndIf
                    If column.Id <> DK then %}                        
                        {% If ((column.Type = "multiple") or ((column.Type = "single") and (CurrentADC.PropValue("colAsComboBox"+i) = "0"))) Then%}
                            {% For k = 1 To column.AvailableResponses.Count%}
                                <th></th>
                            {% Next
                        Elseif column.Type = "numeric" Then %}
            				<th id="totalCell{%= CurrentADC.InstanceId %}_{%= i %}">{%= totalCaptionCol %}<span id="totalCol{%= CurrentADC.InstanceId %}_{%= i %}">{%= CurrentADC.PropValue("numBoxPrefix"+i)%}<span id="total{%= CurrentADC.InstanceId %}_{%= i %}">0</span>{%= CurrentADC.PropValue("numBoxSuffix"+i)%}</span></th>
                        {% Else%}
                            <th>&nbsp;</th>
                        {%EndIf%}
                    {% Endif   
                Next %}
        </tr>
	{% EndIf %}
    </tbody>
</table>
</div>